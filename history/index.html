<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>高考历史特训（手机专用版）</title>
    <!-- 引入 EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #16a34a;
            --success-bg: #dcfce7;
            --danger: #dc2626;
            --danger-bg: #fee2e2;
            --warning: #ca8a04;
            --warning-bg: #fef9c3;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --text-main: #111827;
            --text-sub: #6b7280;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--gray-100);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        /* 顶部导航 */
        header {
            background-color: var(--gray-800);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .progress-container {
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .master-count {
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
        }

        .progress-bar-bg {
            width: 60px;
            height: 6px;
            background-color: #4b5563;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background-color: #facc15;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* 主容器 */
        .container {
            padding: 1rem;
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px; /* 为底部按钮留空间 */
        }

        /* 卡片样式 */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            overflow: hidden;
            border: 1px solid var(--gray-200);
        }

        .card-header {
            background-color: var(--gray-50);
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tag {
            background-color: #dbeafe;
            color: #1e40af;
            font-size: 0.75rem;
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .status-badge {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            display: none; /* 默认隐藏，有状态才显示 */
        }
        .status-mastered {
            background-color: var(--success-bg);
            color: var(--success);
            display: inline-block;
        }
        .status-review {
            background-color: var(--danger-bg);
            color: var(--danger);
            display: inline-block;
        }

        .card-body {
            padding: 1.25rem;
        }

        .q-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 0;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .q-content {
            background-color: var(--gray-50);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--gray-200);
            margin-bottom: 1rem;
        }

        /* 诊断框 */
        .diagnosis-box {
            background-color: var(--danger-bg);
            border-left: 4px solid var(--danger);
            padding: 1rem;
            border-radius: 0 4px 4px 0;
            margin-top: 1rem;
        }

        .diagnosis-title {
            color: #991b1b;
            font-weight: bold;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        /* 输入区 */
        textarea {
            width: 100%;
            height: 200px;
            padding: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            margin-bottom: 1rem;
            -webkit-appearance: none;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* 按钮 */
        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: opacity 0.2s;
        }

        .btn:active {
            opacity: 0.8;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-next {
            background-color: var(--gray-800);
            color: white;
        }

        .btn-outline {
            background-color: white;
            border: 1px solid var(--gray-200);
            color: var(--gray-700);
            margin-top: 1rem;
        }

        /* 评价按钮组 */
        .eval-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px dashed var(--gray-200);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        /* 对比区域 */
        .review-section {
            display: none;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .comparison-grid {
            display: grid;
            gap: 1rem;
        }

        .answer-box {
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            white-space: pre-line;
        }

        .old-answer {
            background-color: var(--danger-bg);
            border: 1px solid #fecaca;
            color: #7f1d1d;
        }

        .new-answer {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            color: #1e3a8a;
        }

        .std-box {
            background-color: white;
            border: 1px solid var(--success);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .std-header {
            background-color: var(--success);
            color: white;
            padding: 10px 15px;
            font-weight: bold;
        }

        .std-body {
            padding: 1.25rem;
        }

        .highlight-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .highlight-list li {
            padding-left: 1.5rem;
            position: relative;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray-700);
        }

        .highlight-list li::before {
            content: "•";
            color: var(--warning);
            font-weight: bold;
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: -5px;
        }

        /* 欢迎页 */
        #welcome-screen {
            text-align: center;
            padding: 2rem 1rem;
        }
        
        .welcome-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        /* 设置框 */
        .setting-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            border: 1px solid #e5e7eb;
            text-align: left;
        }

        .setting-label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .input-num {
            width: 100%;
            padding: 10px;
            font-size: 1.1rem;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            text-align: center;
        }

        /* 结算页 */
        #completion-screen {
            text-align: center;
            padding: 1rem;
        }

        .summary-list {
            text-align: left;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border: 1px solid #e5e7eb;
            max-height: 400px;
            overflow-y: auto;
        }

        .summary-item {
            padding: 10px;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .summary-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .summary-answer {
            background-color: #f9fafb;
            padding: 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            color: #4b5563;
        }

        .email-status {
            padding: 10px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 0.9rem;
            background: #f3f4f6;
        }

        .hidden {
            display: none !important;
        }
        
        .cloud-status {
            font-size: 0.7rem;
            color: #9ca3af;
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <h1>📜 历史特训</h1>
            <div class="progress-container">
                <span class="master-count" id="master-count">已掌握: 0</span>
                <span id="progress-text">1/--</span>
                <div class="progress-bar-bg">
                    <div id="progress-bar" class="progress-bar-fill"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        
        <!-- 欢迎页 -->
        <div id="welcome-screen">
            <div class="welcome-icon">🎯</div>
            <h2 style="margin-bottom: 0.5rem;">高考历史 · 弱项定向诊疗</h2>
            <p style="color: var(--text-sub); margin-bottom: 2rem;">
                专为手机优化。<br>
                本地自动记录做题进度。<br>
                <span id="cloud-indicator">☁️ 数据将同步到云端</span>
            </p>

            <div class="setting-box">
                <label class="setting-label">📅 今日计划刷题数：</label>
                <input type="number" id="daily-goal-input" class="input-num" value="5" min="1" max="50">
                <div style="font-size:0.8rem; color:#6b7280; margin-top:5px;">完成后将自动发送报告到邮箱</div>
            </div>

            <button onclick="window.startPractice()" class="btn btn-primary">开始特训</button>
            <p style="margin-top:1rem; font-size:0.8rem; color:#9ca3af; cursor:pointer;" onclick="window.clearData()">[重置所有记录]</p>
        </div>

        <!-- 答题页 -->
        <div id="practice-screen" class="hidden">
            
            <!-- 题目卡片 -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <span class="tag" id="q-year">年份</span>
                        <span id="status-badge" class="status-badge"></span>
                    </div>
                    <span class="score-tag" id="q-score-info">得分信息</span>
                </div>
                <div class="card-body">
                    <h3 class="q-title" id="q-title">题目</h3>
                    <div class="q-content" id="q-content">内容</div>
                    
                    <div class="diagnosis-box">
                        <div class="diagnosis-title">⚠️ 上次的致命伤</div>
                        <div style="font-size: 0.9rem;" id="q-diagnosis"></div>
                    </div>
                </div>
            </div>

            <!-- 输入区 -->
            <div id="input-section" class="card" style="padding: 1rem;">
                <label style="display:block; font-weight:bold; margin-bottom:0.5rem;">你的新回答：</label>
                <textarea id="user-input" placeholder="请输入你的答案..."></textarea>
                <div style="display: flex; gap: 12px;">
                    <button onclick="window.skipQuestion()" class="btn" style="background: white; border: 1px solid #e5e7eb; color: #6b7280; flex: 1;">跳过 ↷</button>
                    <button onclick="window.submitAnswer()" class="btn btn-primary" style="flex: 2;">提交并对比 ➔</button>
                </div>
            </div>

            <!-- 复盘区 -->
            <div id="review-section" class="review-section">
                
                <div class="comparison-grid">
                    <div>
                        <div style="font-weight:bold; color:#991b1b; margin-bottom:5px;">❌ 你的旧回答</div>
                        <div class="answer-box old-answer" id="old-answer-display"></div>
                    </div>
                    <div>
                        <div style="font-weight:bold; color:#1e40af; margin-bottom:5px;">✍️ 你的新回答</div>
                        <div class="answer-box new-answer" id="new-answer-display"></div>
                    </div>
                </div>

                <!-- 标准答案 -->
                <div class="std-box">
                    <div class="std-header">★ 标准答案 & 逻辑</div>
                    <div class="std-body">
                        <div style="background:#fef9c3; padding:10px; border-radius:4px; margin-bottom:1rem;">
                            <strong style="color:#854d0e; font-size:0.8rem; display:block; margin-bottom:4px;">阅卷人视角</strong>
                            <div id="examiner-notes" style="font-size:0.9rem;"></div>
                        </div>

                        <div style="margin-bottom:1rem;">
                            <strong style="color:#166534; font-size:0.8rem; display:block; margin-bottom:4px;">参考答案</strong>
                            <div id="std-answer-display" style="font-size:0.95rem; color:#1f2937;"></div>
                        </div>

                        <hr style="border:0; border-top:1px solid #e5e7eb; margin:1rem 0;">

                        <div>
                            <strong style="color:#4338ca; font-size:0.8rem; display:block; margin-bottom:4px;">🚀 提分关键</strong>
                            <ul id="key-takeaways" class="highlight-list"></ul>
                        </div>
                    </div>
                </div>
                
                <!-- 自评区域 -->
                <div class="card" style="margin-top: 1.5rem; padding: 1.25rem;">
                    <div style="text-align: center; font-weight: bold; margin-bottom: 1rem;">自我评价：这道题现在掌握了吗？</div>
                    <div class="eval-grid" style="margin-top: 0; border: none; padding-top: 0;">
                        <button onclick="window.markResult(false)" class="btn btn-danger">🔴 需复习</button>
                        <button onclick="window.markResult(true)" class="btn btn-success">✅ 已掌握</button>
                    </div>
                    <div id="upload-status" class="cloud-status" style="text-align:center;"></div>
                </div>

                <div style="margin-top: 1.5rem;">
                    <button onclick="window.nextQuestion()" class="btn btn-next" id="btn-next-step">跳过评价进入下一题 ➔</button>
                </div>

            </div>

        </div>

        <!-- 结算页 -->
        <div id="completion-screen" class="hidden">
            <div class="welcome-icon">🎉</div>
            <h2>今日特训完成！</h2>
            <p>已完成今日设定的目标。</p>
            
            <div class="summary-list" id="session-summary-list">
                <!-- JS 会填充这里 -->
            </div>

            <div id="email-report-status" class="email-status">
                📨 正在生成邮件报告...
            </div>

            <button onclick="location.reload()" class="btn btn-primary" style="margin-top: 20px;">返回首页</button>
        </div>

    </div>

    <script type="module">
        // ----------------------------------------------------
        // FIREBASE 配置区域
        // 修正：将原有的 11.6.1 版本改为 10.8.0 稳定版，防止因版本号错误导致JS不运行
        // ----------------------------------------------------
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // 邮件配置
        const EMAIL_CONFIG = {
            serviceID: "service_j2ak28v",
            templateID: "template_ol3ws9o",
            publicKey: "bGbqCw1wlTrkCwfFo"
        };

        // 初始化 EmailJS
        (function() {
            if(window.emailjs) {
                emailjs.init(EMAIL_CONFIG.publicKey);
            } else {
                console.error("EmailJS SDK failed to load");
            }
        })();

        const firebaseConfig = {
          apiKey: "AIzaSyCb3qEBV8BYmkP3qjEAqlpGkM0kz-Lr7PE",
          authDomain: "history-app-6e0f3.firebaseapp.com",
          projectId: "history-app-6e0f3",
          storageBucket: "history-app-6e0f3.firebasestorage.app",
          messagingSenderId: "1065684045418",
          appId: "1:1065684045418:web:3f99560b0e51decb0c0413",
          measurementId: "G-PELR13Y7YS"
        };

        // 初始化 Firebase
        let db = null;
        let auth = null;
        let userId = "guest";
        let isCloudEnabled = false;

        if (firebaseConfig.apiKey !== "YOUR_API_KEY") {
            try {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                
                signInAnonymously(auth).then((userCredential) => {
                    userId = userCredential.user.uid;
                    isCloudEnabled = true;
                    console.log("云端连接成功，用户ID:", userId);
                    document.getElementById('cloud-indicator').innerText = "☁️ 云端已连接";
                    document.getElementById('cloud-indicator').style.color = "#16a34a";
                }).catch((error) => {
                    console.error("登录失败:", error);
                });
            } catch (e) {
                console.error("Firebase 初始化失败，请检查配置:", e);
            }
        }

        // ----------------------------------------------------
        // 核心逻辑
        // ----------------------------------------------------

        // 题目数据
        const questions = [
            {
                id: 1,
                year: "2015 高考历史",
                title: "第13题：儒学的发展（汉代 vs 宋代）",
                content: `<strong>（1）指出汉代儒学与孔孟儒学的不同之处，并概括宋代理学在哪些方面对儒学有所发展。</strong><br><br>
                          <strong>（2）指出韩愈、康有为关于儒学认识的共通之处。</strong><br><br>
                          <strong>（3）我们应当以什么样的态度对待孔子与儒学？</strong>`,
                oldAnswer: `（1）孔孟是仁政，民本教化；汉儒是皇权神授。发展：重视儒家经典\n（2）借儒家影响为现实服务；重视孔孟经典\n（3）态度：取其精华，去其糟粕；要用理性的眼光看待前人`,
                scoreInfo: "旧得分：失分严重",
                diagnosis: `1. <strong>词汇匮乏：</strong> 宋代理学核心在于<span style="color:red">思辨化、哲学化</span>。<br>
                            2. <strong>漏点：</strong> 汉代儒学吸收了法家、道家思想（大一统）。<br>
                            3. <strong>概念缺失：</strong> 未提及“存天理，灭人欲”。`,
                examinerNotes: [
                    "汉代儒学：大一统、天人感应。",
                    "宋代理学：思辨化、哲学化、伦理纲常。",
                    "你的旧回答第2问抓得准，但第1问太笼统。"
                ],
                stdAnswer: `<strong>（1）不同：</strong> 孔孟讲“仁/礼/民本”；汉儒讲“大一统/天人感应/君权神授”（吸纳法道阴阳）。<br>
                            <strong>发展：</strong> 吸收佛道思想；使儒学<strong>思辨化、哲学化</strong>；提出“存天理，灭人欲”。<br><br>
                            <strong>（2）共通：</strong> 回归原典（否定后世流变）；托古改制；服务于现实政治。<br><br>
                            <strong>（3）态度：</strong> 批判继承；结合时代创新。`,
                takeaways: [
                    "提到宋明理学，必须反射出关键词：<strong>思辨化、哲学化、存天理灭人欲</strong>。",
                    "对比题注意：A有B无，B有A无。"
                ]
            },
            {
                id: 2,
                year: "2015 高考历史",
                title: "第14题：科学技术与生产力公式（论述题）",
                content: `<strong>运用世界近现代史的史实，对公式（生产力=科学技术×（劳动力+劳动工具+劳动对象+生产管理））进行探讨。</strong>`,
                oldAnswer: `（1）1第一次工业革命提高社会生产力，建设工业制度\n（2）2第二次工业革命出现垄断组织跨国公司，提高生产水平\n（3）3第三次科技革命，提高生产效率，社会进入信息时代`,
                scoreInfo: "旧得分：逻辑脱节",
                diagnosis: `1. <strong>逻辑断层：</strong> 未扣住公式里的具体项（劳动力、工具、管理）。<br>
                            2. <strong>缺少结构：</strong> 缺少明确的观点句和总结句。`,
                examinerNotes: [
                    "论据选择正确（三次革命）。",
                    "缺乏与公式要素（工具、管理）的对应分析。",
                    "缺观点句。"
                ],
                stdAnswer: `<strong>观点：</strong> 科技是第一生产力，对各要素有放大效应。<br>
                            <strong>论证：</strong><br>
                            1. <strong>工具：</strong> 蒸汽机→电气化→自动化。<br>
                            2. <strong>管理：</strong> 工厂制度→垄断组织→现代企业管理。<br>
                            3. <strong>劳动力：</strong> 体力→脑力。<br>
                            <strong>总结：</strong> 科技推动要素重组，促进发展。`,
                takeaways: [
                    "论述题公式：<strong>观点 + 分论点（紧扣题目关键词） + 史实支撑 + 总结</strong>。"
                ]
            },
            {
                id: 3,
                year: "2015 高考历史",
                title: "第15题：唐代币制改革",
                content: `<strong>（1）指出唐代币制改革的主要内容。</strong><br>
                          <strong>（2）说明唐代币制改革的意义。</strong>`,
                oldAnswer: `（1）内容：推进十进位制的转变，不用钱币重量体现钱币价值\n（2）意义：开启新的货币体系，有利于经济的发展，方便日常货币的使用`,
                scoreInfo: "旧得分：良好",
                diagnosis: `1. <strong>术语不准：</strong> 应为“通宝/元宝体制”（不再以重量命名）。<br>
                            2. <strong>深度不够：</strong> 应拔高到“确立了历代铸币范式”。`,
                examinerNotes: [
                    "抓住了十进位制，方向正确。",
                    "补充“范式”和“商品经济发展”会更好。"
                ],
                stdAnswer: `<strong>（1）内容：</strong> 开创“通宝/元宝”体制；确立十进位制；统一币制。<br>
                            <strong>（2）意义：</strong> 结束混乱，利于商品经济；确立后世范式；方便计算。`,
                takeaways: [
                    "经济史意义：对当时（经济发展）、对后世（制度范式）、对操作（便利）。"
                ]
            },
            {
                id: 4,
                year: "2015 高考历史",
                title: "第16题：抗战前后党派地位变化",
                content: `<strong>（1）概括指出抗战胜利前后各党派地位发生的变化。</strong><br>
                          <strong>（2）分析各党派地位变化的原因及影响。</strong>`,
                oldAnswer: `（1）变化：抗日战争时期，各党派于国民党领导下，抗日胜利，多数党派在宪法下一律地位平等\n（2）原因：国共两党实力发生巨大变化，美国和苏联在背后的影响`,
                scoreInfo: "旧得分：严重漏答",
                diagnosis: `1. <strong>审题大忌：</strong> 题目问“原因及<strong style='color:red'>影响</strong>”，你完全漏掉了“影响”！<br>
                            2. <strong>原因不全：</strong> 忽视了内因（抗战贡献、民心）。`,
                examinerNotes: [
                    "严重漏点，完全未回答“影响”。",
                    "原因部分忽视了内部因素。"
                ],
                stdAnswer: `<strong>（1）变化：</strong> 国民党一党专政 → 各党派法律上平等。<br>
                            <strong>（2）原因：</strong> 团结抗战力量壮大；中共增强；民心所向；国际制约。<br>
                            <strong>影响：</strong> 促成政协会议；利于民主政治；为新中国奠基；打破专政。`,
                takeaways: [
                    "看到“原因及影响”，必须在草稿纸上圈出来，强制分段。"
                ]
            },
            {
                id: 5,
                year: "2015 高考历史",
                title: "第17题：戴高乐与法国复兴",
                content: `<strong>（1）概括戴高乐号召抵抗的理由。</strong><br>
                          <strong>（2）总结法国复兴的历史经验。</strong><br>
                          <small style='color:#666'>材料提示：“没有输掉战争”、“庞大帝国”、“盟友”。</small>`,
                oldAnswer: `（1）原因：统治者需要治理庞大的帝国，善于劝诫\n（2）意义：维护国家安定，为后代提供参考价值，有重要的文献价值`,
                scoreInfo: "旧得分：0分 (跑题)",
                diagnosis: `1. <strong>幻视：</strong> 答成了古代史或史书评价。<br>
                            2. <strong>脱离材料：</strong> 必须依据材料里的“盟友”、“殖民地”作答。`,
                examinerNotes: [
                    "严重审题/知识点错误。",
                    "必须依据材料：戴高乐演讲内容。"
                ],
                stdAnswer: `<strong>（1）理由：</strong> 胜败未定；有殖民地后盾；有盟友支持；正义必胜。<br>
                            <strong>（2）经验：</strong> 坚持独立主权；依靠人民；国际合作；调整策略。`,
                takeaways: [
                    "不懂背景不要编，答案全在材料里。"
                ]
            },
            {
                id: 6,
                year: "2016 高考历史",
                title: "第13题：清中期人口与近代主张",
                content: `<strong>（1）说明清中期人口膨胀的原因及影响。</strong><br>
                          <strong>（2）概括近代学者主张并评价。</strong>`,
                oldAnswer: `原因：政治稳定，高产作物。影响：土地紧张。\n主张：计生，改良农业。评价：借鉴，移民不可行。`,
                scoreInfo: "旧得分：18/25",
                diagnosis: `1. <strong>细节丢失：</strong> 漏掉“生态破坏”、“人均收入下降”。<br>
                            2. <strong>评价空泛：</strong> “提供借鉴”是废话。要具体评析实业、移民的优劣。`,
                examinerNotes: [
                    "漏掉农作制改进、生态恶化。",
                    "评价过于笼统。"
                ],
                stdAnswer: `<strong>（1）原因：</strong> 稳定；税改；复种；高产作物；耕地扩大。<br>
                            <strong>影响：</strong> 人地矛盾；生态恶化；收入下降；游手好闲；民变。<br>
                            <strong>（2）评价：</strong> 移民缓解但破环生态；实业治本但需资金；节育根本但受观念制约。`,
                takeaways: [
                    "概括题要像剥洋葱，每一句话都是得分点。"
                ]
            },
            {
                id: 7,
                year: "2016 高考历史",
                title: "第14题：卢梭思想与制度（小论文）",
                content: `<strong>围绕“制度构想与实践”拟定论题并阐述。</strong><br>
                          <small>卢梭反对代议制，认为英国人选出议员后就是奴隶。</small>`,
                oldAnswer: `英国君主立宪，国王世袭无权...`,
                scoreInfo: "旧得分：4/12",
                diagnosis: `1. <strong>格式错误：</strong> 未写“论题：xxxx”。<br>
                            2. <strong>缺乏思辨：</strong> 只写了英国制度，未结合卢梭观点的“理想vs现实”冲突。`,
                examinerNotes: [
                    "未拟定论题。",
                    "未分析卢梭思想与代议制的矛盾。"
                ],
                stdAnswer: `<strong>论题：</strong> 卢梭人民主权理论的理想性与代议制实践的现实性。<br>
                            <strong>阐述：</strong> 卢梭主张直接民主（理想性）在大国难实现；代议制（现实性）虽有缺陷但通过分权制衡防止暴政。<br>
                            <strong>结论：</strong> 代议制是现代政治的现实选择。`,
                takeaways: [
                    "小论文必写标题。",
                    "体现'理想 vs 现实'的张力。"
                ]
            },
            {
                id: 8,
                year: "2018 高考历史",
                title: "第13题(1)：宋代到明清乡约制度的变化",
                content: `<strong>根据材料一并结合所学知识，概括宋代到明清时期乡约制度的变化，并说明乡约制度的积极作用。</strong>`,
                oldAnswer: `制定规约进行道德教化；功能是扬善惩恶。明清：宣讲"圣谕"成为乡约最重要的内容，加强对人民的思想控制，有利于促进农业经济发展。`,
                scoreInfo: "旧得分：约5~7分（满分12分左右）",
                diagnosis: `1. <strong>变化部分</strong>答得不完整，只提到了内容变化，未点明推行主体的变化（从民间自发→官府主导推行），也未指出功能变化（道德教化→政治教化/思想控制）。<br>
                            2. "积极作用"部分混入了"加强思想控制"这一中性乃至负面表述，题目问的是<strong>积极作用</strong>，需注意角度。<br>
                            3. 促进农业经济发展这一点论据不足，材料中仅提到"重农桑"，不能直接得出此结论。`,
                examinerNotes: [
                    "变化：推行主体变化（民间士绅→官府主导）；内容变化（道德教化→宣讲圣谕）；功能变化（乡村自我管理→国家统治工具）。",
                    "积极作用：维护基层社会秩序；道德教化；弥补国家行政不足。",
                    "注意题目要求的是'积极作用'，不要写负面内容。"
                ],
                stdAnswer: `<strong>变化：</strong><br>
                            ① 推行主体变化：由民间士绅自发组织→地方官府主导推行；<br>
                            ② 内容变化：以道德教化、扬善惩恶为主→以宣讲皇帝"圣谕"为核心，政治功能强化；<br>
                            ③ 功能变化：偏重乡村自我道德管理→成为国家基层统治和思想控制的工具。<br><br>
                            <strong>积极作用：</strong><br>
                            ① 有利于维护基层社会秩序，化解民间矛盾；<br>
                            ② 有利于道德教化，凝聚乡村共同体；<br>
                            ③ 弥补了国家正式行政体系在基层的不足，有助于国家治理。`,
                takeaways: [
                    "变化题要从<strong>主体、内容、功能</strong>多角度分析。",
                    "问'积极作用'就只写积极面，不要混入负面评价。"
                ]
            },
            {
                id: 9,
                year: "2018 高考历史",
                title: "第13题(2)：清末城镇乡地方自治的历史背景",
                content: `<strong>根据材料二并结合所学知识，简述清末城镇乡地方自治的历史背景。</strong>`,
                oldAnswer: `清末民族危机严重，清政府实行清末新政，受西方民主影响。`,
                scoreInfo: "旧得分：约4~5分（满分5分左右）",
                diagnosis: `答案方向正确，但过于简略，仅三点且每点均缺乏展开。高考评分要求每点需有一定说明性表述。`,
                examinerNotes: [
                    "方向正确，但需要展开说明。",
                    "应补充：地方自治被视为强国之基；知识分子积极倡导；士绅阶层推动实践。"
                ],
                stdAnswer: `① 民族危机加深，救亡图存成为时代主题，地方自治被视为强国之基；<br>
                            ② 清政府推行"清末新政"（预备立宪），地方自治是其重要内容；<br>
                            ③ 西方民主政治思想（如卢梭社会契约论、地方自治理念）传入中国，知识分子积极倡导；<br>
                            ④ 戊戌变法失败后，改良思潮仍有影响，士绅阶层推动地方自治实践。`,
                takeaways: [
                    "背景题要从<strong>政治、思想、社会</strong>多角度展开。",
                    "每个要点都要有说明性语言，不能只列关键词。"
                ]
            },
            {
                id: 10,
                year: "2018 高考历史",
                title: "第13题(3)：村民自治的意义",
                content: `<strong>根据材料三并结合所学知识，说明村民自治的意义。</strong>`,
                oldAnswer: `维护社会稳定，促进经济发展，调动农民政治积极性。`,
                scoreInfo: "旧得分：约3~4分（满分8分左右）",
                diagnosis: `三个角度方向基本正确，但均未展开说明，且遗漏了重要角度，如法治建设、民主制度建设等层面。`,
                examinerNotes: [
                    "方向正确但未展开。",
                    "遗漏了民主政治建设、法治建设等重要角度。"
                ],
                stdAnswer: `① 扩大了基层民主，保障了农民的民主权利，调动了农民参政积极性；<br>
                            ② 有利于加强农村基层政权建设，维护农村社会稳定；<br>
                            ③ 推动了中国社会主义民主政治建设进程；<br>
                            ④ 促进了农村经济发展和社会和谐；<br>
                            ⑤ 为基层治理现代化提供了制度保障，丰富了"一国两制"以外的民主实践形式。`,
                takeaways: [
                    "意义题要从<strong>对个人、对基层、对国家、对制度</strong>多层次分析。",
                    "不要只列要点，每点都要有具体说明。"
                ]
            },
            {
                id: 11,
                year: "2018 高考历史",
                title: "第14题：近代早期历史现象（黑奴贸易）",
                content: `<strong>提取一个情节，指出其反映的近代早期重大历史现象，并概述和评价该历史现象。</strong><br>
                          <small style='color:#666'>提示：鲁滨逊漂流记中的相关情节</small>`,
                oldAnswer: `近代殖民始于新航路开辟，在亚非拉强占殖民地，掠夺财富，为资本主义提供资本积累，客观上带动世界市场的发展。`,
                scoreInfo: "旧得分：约5~6分（满分12分）",
                diagnosis: `1. <strong>没有明确点出"所提取的情节"</strong>，如"鲁滨逊去非洲贩卖黑奴"，这是格式硬伤，答题结构不完整。<br>
                            2. 将殖民扩张与黑奴贸易混为一谈，"黑奴贸易"（三角贸易）是更具体、更精准的历史现象，而你笼统说"殖民扩张"，针对性不强。<br>
                            3. 评价部分有积极面（资本积累、世界市场），但<strong>缺少对殖民行为残酷性的批判</strong>，评价不全面。`,
                examinerNotes: [
                    "必须先点出具体情节。",
                    "要区分'殖民扩张'和'黑奴贸易'。",
                    "评价要一分为二：既要写积极意义，也要批判其罪恶性质。"
                ],
                stdAnswer: `<strong>情节：</strong> 鲁滨逊前往非洲贩卖黑奴。<br><br>
                            <strong>历史现象：</strong> 近代早期的奴隶贸易（三角贸易）。<br><br>
                            <strong>概述：</strong> 15~19世纪，欧洲殖民者在非洲大肆掳掠黑人，运往美洲充当奴隶，形成欧洲—非洲—美洲之间的"三角贸易"，数百年间共有上千万非洲人被贩卖为奴。<br><br>
                            <strong>评价：</strong> 奴隶贸易是西方殖民扩张的重要组成部分，为欧洲资本主义原始积累提供了大量资金；促进了世界市场的发展和欧美经济繁荣。但其本质是野蛮的人口掠夺，给非洲带来了人口减少、社会动荡的深重灾难，是人类历史上的巨大罪恶。`,
                takeaways: [
                    "答题结构：<strong>情节→现象→概述→评价</strong>，缺一不可。",
                    "评价殖民、战争类题目必须一分为二，既写影响也批判罪恶。"
                ]
            },
            {
                id: 12,
                year: "2018 高考历史",
                title: "第15题(1)：年号纪年制与之前的区别",
                content: `<strong>指出年号纪年制与之前纪年制度的区别。</strong>`,
                oldAnswer: `皇帝诸侯各自纪年，年号制以年号纪年。`,
                scoreInfo: "旧得分：约2~3分（满分4分）",
                diagnosis: `抓住了核心区别，但表述不够完整，未提到年号统一全国通用这一关键点。`,
                examinerNotes: [
                    "核心区别：之前各自纪年；年号制统一、以帝王年号纪年、全国通用。"
                ],
                stdAnswer: `<strong>区别：</strong><br>
                            ① 之前：诸侯王各自纪年，缺乏统一标准；<br>
                            ② 年号制：以皇帝年号纪年，全国统一使用，体现中央集权。`,
                takeaways: [
                    "对比题要明确<strong>A的特点→B的特点</strong>，突出差异。"
                ]
            },
            {
                id: 13,
                year: "2018 高考历史",
                title: "第15题(2)：年号制的影响",
                content: `<strong>说明年号制的影响。</strong>`,
                oldAnswer: `有利于君主集权和维护国家统一，长期使用，影响深远，为世界文明做贡献。`,
                scoreInfo: "旧得分：约4~5分（满分6分）",
                diagnosis: `方向正确，但"为世界文明做贡献"过于空泛。应点明对朝鲜、日本、越南等国的具体影响。`,
                examinerNotes: [
                    "影响：强化皇权；维护统一；规范时间秩序；影响周边国家（朝鲜、日本、越南）。"
                ],
                stdAnswer: `① 有利于强化君主专制和中央集权；<br>
                            ② 维护国家统一，增强政治认同；<br>
                            ③ 规范时间秩序，便于历史记载；<br>
                            ④ 影响周边国家（如朝鲜、日本、越南等）采用类似制度，体现中华文化圈的影响力。`,
                takeaways: [
                    "影响题要具体化，避免空泛表述如'做出贡献'。"
                ]
            },
            {
                id: 14,
                year: "2018 高考历史",
                title: "第16题(1)：一战与二战性质的不同认识",
                content: `<strong>指出1939年和1945年人们对一战与二战性质的两种不同认识。</strong>`,
                oldAnswer: `帝国主义战争；反法西斯的解放战争。`,
                scoreInfo: "旧得分：约3分（满分4分）",
                diagnosis: `准确，简洁到位。`,
                examinerNotes: [
                    "1939年认识：都是帝国主义战争。",
                    "1945年认识：二战是反法西斯的正义战争。"
                ],
                stdAnswer: `<strong>1939年认识：</strong> 一战和二战都是帝国主义战争；<br>
                            <strong>1945年认识：</strong> 二战是反法西斯的正义战争、人民解放战争。`,
                takeaways: [
                    "对比题要明确时间节点，分别说明。"
                ]
            },
            {
                id: 15,
                year: "2018 高考历史",
                title: "第16题(2)：两种认识的历史背景",
                content: `<strong>分析两种认识产生的历史背景。</strong>`,
                oldAnswer: `英国采取绥靖政策，苏德签订互不侵犯条约；太平洋战争爆发，世界反法西斯同盟形成。`,
                scoreInfo: "旧得分：约5~6分（满分8分）",
                diagnosis: `两个背景各抓住了关键事件，基本正确，但对第一种认识（1939年）的背景可以补充"二战初期法西斯与西方列强性质相近，战争本质是帝国主义矛盾激化"。`,
                examinerNotes: [
                    "1939年背景：英法绥靖；苏德条约；二战初期各国性质相近。",
                    "1945年背景：反法西斯同盟形成；战争性质明确为正义对邪恶。"
                ],
                stdAnswer: `<strong>1939年背景：</strong><br>
                            ① 英法对德意采取绥靖政策，姑息法西斯；<br>
                            ② 苏德签订互不侵犯条约，苏联中立；<br>
                            ③ 二战初期，法西斯与西方列强性质相近，都是帝国主义国家，战争本质是帝国主义矛盾激化。<br><br>
                            <strong>1945年背景：</strong><br>
                            ① 太平洋战争爆发，美国参战；<br>
                            ② 世界反法西斯同盟形成，团结抗击法西斯；<br>
                            ③ 战争性质明确为反法西斯侵略的正义战争，得到世界人民支持。`,
                takeaways: [
                    "背景题要结合当时的<strong>外交政策、国际格局、战争性质</strong>分析。"
                ]
            },
            {
                id: 16,
                year: "2018 高考历史",
                title: "第17题(1)：美国两种对拉美政策的不同特征",
                content: `<strong>指出20世纪30年代前后美国两种对拉美政策的不同特征。</strong>`,
                oldAnswer: `中立政策、睦邻政策，积极参与拉美事务。`,
                scoreInfo: "旧得分：约1~2分（满分4分）",
                diagnosis: `<strong>严重失分</strong>，完全没有说明两者的<strong>不同特征</strong>。中立政策是孤立主义、不介入；睦邻政策是以经济政治手段代替武力干涉，二者差异明显，你的答案几乎等于没答。`,
                examinerNotes: [
                    "必须对比两种政策的不同特征。",
                    "30年代前：武力干涉、强权政策；30年代后：睦邻友好、经济合作。"
                ],
                stdAnswer: `<strong>30年代前：</strong> 武力干涉、强权政策（"大棒政策"、"金元外交"）；<br>
                            <strong>30年代后：</strong> 睦邻友好政策，以经济援助和政治合作代替武力干涉，平等对话。`,
                takeaways: [
                    "对比题必须明确<strong>A的特征 vs B的特征</strong>，不能混为一谈。"
                ]
            },
            {
                id: 17,
                year: "2018 高考历史",
                title: "第17题(2)：睦邻政策的作用与实质",
                content: `<strong>说明睦邻政策的作用与实质。</strong>`,
                oldAnswer: `抵制法西斯势力，扩大美国对外贸易，实质是维护美国利益。`,
                scoreInfo: "旧得分：约4~5分（满分6分）",
                diagnosis: `作用和实质方向正确，但作用的表述太简单，少了"推动美洲团结合作""提升美国在拉美影响力"等。`,
                examinerNotes: [
                    "作用：抵制法西斯；推动美洲团结；扩大贸易；提升美国影响力。",
                    "实质：维护美国在拉美的霸权地位和经济利益。"
                ],
                stdAnswer: `<strong>作用：</strong><br>
                            ① 抵制法西斯势力在拉美的渗透；<br>
                            ② 推动泛美团结合作，巩固美洲防务；<br>
                            ③ 扩大美国在拉美的经济贸易；<br>
                            ④ 提升美国在拉美的政治影响力。<br><br>
                            <strong>实质：</strong> 维护和扩大美国在拉美的霸权地位和经济利益，以更隐蔽的方式控制拉美。`,
                takeaways: [
                    "实质题要透过现象看本质：<strong>表面做法→深层目的</strong>。"
                ]
            }
        ];

        let currentIndex = 0;
        const STORAGE_KEY = 'history_training_progress';
        let progressData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
        
        // 每日计划功能变量
        let dailyGoal = 5;
        let sessionCount = 0; // 本次会话已做题数
        let sessionRecords = []; // 记录本次会话的题目和结果

        // 将函数挂载到 window 对象上，以便 HTML 按钮调用
        window.startPractice = function() {
            // 获取用户设定的每日题量
            const inputVal = document.getElementById('daily-goal-input').value;
            dailyGoal = parseInt(inputVal) || 5;
            sessionCount = 0;
            sessionRecords = [];

            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('practice-screen').classList.remove('hidden');
            document.getElementById('practice-screen').style.animation = 'fadeIn 0.5s';
            
            updateStats();
            loadQuestion(0);
        }

        function updateStats() {
            const masteredCount = Object.values(progressData).filter(status => status === 'mastered').length;
            document.getElementById('master-count').innerText = `已掌握: ${masteredCount}`;
            // 显示格式：当前第几题 / 总数 (今日目标: X)
            document.getElementById('progress-text').innerText = `${currentIndex + 1}/${questions.length} (今日目标:${dailyGoal})`;
        }

        function loadQuestion(index) {
            currentIndex = index;
            const q = questions[index];

            updateStats();
            document.getElementById('progress-bar').style.width = `${((index + 1) / questions.length) * 100}%`;

            document.getElementById('q-year').innerText = q.year;
            document.getElementById('q-score-info').innerText = q.scoreInfo;
            document.getElementById('q-title').innerText = q.title;
            document.getElementById('q-content').innerHTML = q.content;
            document.getElementById('q-diagnosis').innerHTML = q.diagnosis;

            const statusBadge = document.getElementById('status-badge');
            statusBadge.className = 'status-badge'; 
            const historyStatus = progressData[q.id];
            
            if (historyStatus === 'mastered') {
                statusBadge.innerText = '✅ 已掌握';
                statusBadge.classList.add('status-mastered');
                statusBadge.style.display = 'inline-block';
            } else if (historyStatus === 'review') {
                statusBadge.innerText = '🔴 需复习';
                statusBadge.classList.add('status-review');
                statusBadge.style.display = 'inline-block';
            } else {
                statusBadge.style.display = 'none';
            }

            document.getElementById('user-input').value = '';
            document.getElementById('input-section').style.display = 'block';
            document.getElementById('review-section').style.display = 'none';
            document.getElementById('upload-status').innerText = '';

            document.getElementById('old-answer-display').innerText = q.oldAnswer;
            document.getElementById('std-answer-display').innerHTML = q.stdAnswer;
            
            document.getElementById('examiner-notes').innerHTML = q.examinerNotes.map(n => `<div>• ${n}</div>`).join('');
            document.getElementById('key-takeaways').innerHTML = q.takeaways.map(t => `<li>${t}</li>`).join('');

            window.scrollTo(0, 0);
        }

        window.submitAnswer = function() {
            const val = document.getElementById('user-input').value;
            if (!val.trim()) {
                alert("请先输入一些关键词");
                return;
            }

            document.getElementById('new-answer-display').innerText = val;
            document.getElementById('input-section').style.display = 'none';
            document.getElementById('review-section').style.display = 'block';
            document.getElementById('review-section').scrollIntoView({ behavior: 'smooth' });
        }
        
        window.markResult = async function(isMastered) {
            const q = questions[currentIndex];
            const status = isMastered ? 'mastered' : 'review';
            const statusText = isMastered ? '✅ 已掌握' : '🔴 需复习';
            
            // 获取用户的回答内容 (在复盘界面显示的那个)
            const userAnswer = document.getElementById('new-answer-display').innerText || "（未记录回答）";
            
            // 记录本次会话数据，用于发邮件
            sessionRecords.push({
                title: q.title,
                status: statusText,
                userAnswer: userAnswer,
                questionId: q.id
            });
            sessionCount++;

            // 1. 本地保存
            progressData[q.id] = status;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(progressData));
            updateStats();

            // 2. 云端保存 (如果已配置)
            if (isCloudEnabled && db) {
                const statusDiv = document.getElementById('upload-status');
                statusDiv.innerText = "⏳ 正在上传数据...";
                try {
                    await addDoc(collection(db, "exam_records"), {
                        userId: userId,
                        questionId: q.id,
                        questionTitle: q.title,
                        status: status, // mastered or review
                        userAnswer: userAnswer, // 同时也存到云端
                        timestamp: serverTimestamp(),
                        dateStr: new Date().toLocaleString()
                    });
                    statusDiv.innerText = "☁️ 数据已同步到云端";
                } catch (e) {
                    console.error("上传失败", e);
                    statusDiv.innerText = "⚠️ 上传失败，请检查网络";
                }
            }
            
            // 检查是否达到今日目标或题目做完
            setTimeout(() => {
                if (sessionCount >= dailyGoal || currentIndex >= questions.length - 1) {
                    finishSession();
                } else {
                    window.nextQuestion();
                }
            }, 800);
        }

        window.skipQuestion = function() {
            window.nextQuestion();
        }

        window.nextQuestion = function() {
            if (currentIndex < questions.length - 1) {
                loadQuestion(currentIndex + 1);
            } else {
                finishSession();
            }
        }
        
        // 结束本次特训，展示结算页并发送邮件
        function finishSession() {
            document.getElementById('practice-screen').classList.add('hidden');
            document.getElementById('completion-screen').classList.remove('hidden');
            
            // 生成摘要HTML
            const summaryContainer = document.getElementById('session-summary-list');
            let summaryHTML = "";
            let emailContentText = ""; // 纯文本内容用于邮件

            sessionRecords.forEach((record, index) => {
                // UI 展示摘要
                summaryHTML += `
                    <div class="summary-item">
                        <div class="summary-header">
                            <span>${index + 1}. ${record.title}</span>
                            <strong>${record.status}</strong>
                        </div>
                        <div class="summary-answer">
                            我的回答：${record.userAnswer.substring(0, 40)}${record.userAnswer.length > 40 ? '...' : ''}
                        </div>
                    </div>
                `;
                
                // 邮件文本内容
                emailContentText += `----------------------------------------\n`;
                emailContentText += `题目 ${index + 1}: ${record.title}\n`;
                emailContentText += `状态: ${record.status}\n`;
                emailContentText += `你的回答:\n${record.userAnswer}\n`;
                emailContentText += `----------------------------------------\n\n`;
            });
            summaryContainer.innerHTML = summaryHTML;

            // 调用发送邮件功能
            sendEmailReport(emailContentText);
        }

        // 发送邮件功能
        function sendEmailReport(content) {
            const statusDiv = document.getElementById('email-report-status');
            
            if (!sessionRecords.length) {
                statusDiv.innerText = "⚠️ 本次未做题，无报告发送。";
                return;
            }

            // 准备模板参数
            // 这里假设模板里有一个 {{message}} 或类似的变量来接收主要内容
            // 我们构造一个包含日期和详情的字符串
            const todayStr = new Date().toLocaleString();
            const reportData = {
                to_name: "用户", // 如果有用户名可替换
                message: `
[历史特训报告 - ${todayStr}]
今日目标: ${dailyGoal}题
实际完成: ${sessionRecords.length}题

=== 详细复盘 ===
${content}
                `
            };

            emailjs.send(EMAIL_CONFIG.serviceID, EMAIL_CONFIG.templateID, reportData)
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    statusDiv.innerHTML = "✅ 邮件报告已发送成功！<br>包含每道题的详细回答和掌握情况。";
                    statusDiv.style.background = "#dcfce7";
                    statusDiv.style.color = "#166534";
                }, function(error) {
                    console.log('FAILED...', error);
                    statusDiv.innerHTML = "❌ 邮件发送失败。<br>请检查网络或配置。";
                    statusDiv.style.background = "#fee2e2";
                    statusDiv.style.color = "#991b1b";
                });
        }

        window.clearData = function() {
            if(confirm('确定要清除所有做题记录吗？')) {
                localStorage.removeItem(STORAGE_KEY);
                progressData = {};
                alert('记录已重置');
                location.reload();
            }
        }
    </script>
</body>
</html>